{"version":3,"file":"esm-bundle.js","mappings":"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","sources":["webpack://staction/webpack/bootstrap","webpack://staction/webpack/runtime/define property getters","webpack://staction/webpack/runtime/hasOwnProperty shorthand","webpack://staction/./src/Staction.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import type {\n  InitState,\n  UserActions,\n  StactionActions,\n  StactionMiddlewareParams,\n} from './Staction.d';\n\ntype TestSubject = {\n  [Symbol.iterator]: string;\n  [Symbol.asyncIterator]: string;\n};\n\nfunction isIterable(testSubject: TestSubject): boolean {\n  return typeof testSubject[Symbol.iterator] === 'function';\n}\n\nfunction isAsyncIterable(testSubject: TestSubject) {\n  return typeof testSubject[Symbol.asyncIterator] === 'function';\n}\n\nfunction isPromise(obj: any): obj is Promise<any> {\n  return (\n    !!obj &&\n    (typeof obj === 'object' || typeof obj === 'function') &&\n    typeof obj.then === 'function'\n  );\n}\n\nfunction isGeneratorFunction(testSub: any): boolean {\n  return testSub && typeof testSub.next === 'function' && isIterable(testSub);\n}\n\nfunction isAsyncGeneratorFunction(testSub: any): boolean {\n  return (\n    testSub && typeof testSub.next === 'function' && isAsyncIterable(testSub)\n  );\n}\n\ninterface StactionMiddleware {\n  type: 'pre' | 'post';\n  method: Function;\n  meta: object;\n}\n\nclass Staction<State, ActionsInput extends UserActions<State, ActionsInput>> {\n  private _initState: InitState = 'uninitialized';\n  private _actions!: ActionsInput;\n\n  private _wrappedActions: StactionActions<State, ActionsInput> = {} as any;\n\n  private _state: State = {} as State;\n  private _stateSetCallback: Function = () => {};\n  private _loggingEnabled: boolean = true;\n  private _addStateToLogs: boolean = false;\n  private _preMiddleware: StactionMiddleware[] = [];\n  private _postMiddleware: StactionMiddleware[] = [];\n\n  async init(\n    actions: ActionsInput,\n    initFunc: (\n      actions: StactionActions<State, ActionsInput>\n    ) => Promise<State> | State,\n    stateSetCallback: (\n      state: State,\n      actions: StactionActions<State, ActionsInput>\n    ) => void\n  ) {\n    if (this._initState !== 'uninitialized') {\n      let errorMsg = '';\n      switch (this._initState) {\n        case 'initialized':\n          errorMsg = 'Staction instance has already been initialized';\n          break;\n        case 'initializing':\n          errorMsg = 'Staction instance is currently being initialized';\n          break;\n        case 'initerror':\n        default:\n          errorMsg =\n            'An error has previously occured when trying to init this instance';\n          break;\n      }\n      const err = new Error(errorMsg);\n      console.error(err);\n      throw err;\n    }\n\n    try {\n      this._initState = 'initializing';\n      this._stateSetCallback = stateSetCallback;\n\n      this._wrappedActions = Object.entries(actions).reduce(\n        (acc, [name, actionFunc]) => {\n          (acc as any)[name as keyof ActionsInput] = (...args: any[]) =>\n            this.actionWrapper(name, actionFunc as Function, ...args);\n          return acc;\n        },\n        {} as StactionActions<State, ActionsInput>\n      );\n\n      this._actions = actions;\n      const initialStateCandidate = initFunc(this._wrappedActions as any);\n      if (isPromise(initialStateCandidate)) {\n        this._state = await initialStateCandidate;\n      } else {\n        this._state = initialStateCandidate;\n      }\n\n      this._initState = 'initialized';\n    } catch (e) {\n      this._initState = 'initerror';\n      console.error(e);\n      throw e;\n    }\n  }\n\n  get actions(): StactionActions<State, ActionsInput> {\n    return this._wrappedActions;\n  }\n\n  get state(): State {\n    return this._state;\n  }\n\n  get initialized(): boolean {\n    return this._initState === 'initialized';\n  }\n\n  get initState(): InitState {\n    return this._initState;\n  }\n\n  getState = (): State => {\n    return this._state;\n  };\n\n  async actionWrapper(\n    name: string,\n    func: Function,\n    ...args: any[]\n  ): Promise<{ state: State; aux: any | undefined }> {\n    if (this._loggingEnabled) {\n      if (this._addStateToLogs) {\n        console.log('action: ', name, this._state);\n      } else {\n        console.log('action: ', name);\n      }\n    }\n\n    let auxData: any | undefined = undefined;\n\n    const updateAuxData = (\n      valueOrUpdater: any | ((currentValue: any | undefined) => any)\n    ) => {\n      if (typeof valueOrUpdater === 'function') {\n        auxData = (valueOrUpdater as Function)(auxData);\n      } else {\n        auxData = valueOrUpdater;\n      }\n    };\n\n    const params = {\n      state: this.getState,\n      actions: this._wrappedActions as any,\n      aux: updateAuxData,\n      name: name,\n    };\n\n    try {\n      await this.processMiddleware(this._preMiddleware, name, args);\n      const newState = func(params, ...args);\n      await this.handleActionReturnTypes(newState);\n      await this.processMiddleware(this._postMiddleware, name, args);\n\n      if (\n        !isGeneratorFunction(newState) &&\n        !isAsyncGeneratorFunction(newState)\n      ) {\n        this.callSetStateCallback(this._state);\n      }\n\n      return { state: this._state, aux: auxData };\n    } catch (e) {\n      throw e;\n    }\n  }\n\n  handleActionReturnTypes = async (newState: any): Promise<void> => {\n    try {\n      if (isPromise(newState)) {\n        this._state = await newState;\n      } else if (isGeneratorFunction(newState)) {\n        let result = newState.next();\n        while (!result.done) {\n          await this.handleActionReturnTypes(result.value);\n          this.callSetStateCallback(this._state);\n          result = newState.next();\n        }\n        if (result.value !== undefined) {\n          await this.handleActionReturnTypes(result.value);\n          this.callSetStateCallback(this._state);\n        }\n      } else if (isAsyncGeneratorFunction(newState)) {\n        let result = await newState.next();\n        while (!result.done) {\n          await this.handleActionReturnTypes(result.value);\n          this.callSetStateCallback(this._state);\n          result = await newState.next();\n        }\n        if (result.value !== undefined) {\n          await this.handleActionReturnTypes(result.value);\n          this.callSetStateCallback(this._state);\n        }\n      } else {\n        if (newState !== undefined) {\n          this._state = newState;\n        }\n      }\n    } catch (e) {\n      throw e;\n    }\n  };\n\n  processMiddleware = async (\n    middleware: StactionMiddleware[],\n    name: string,\n    args: any[]\n  ): Promise<void> => {\n    for (const m of middleware) {\n      if (typeof m.method === 'function') {\n        const params: StactionMiddlewareParams<State> = {\n          state: this.getState,\n          name,\n          args,\n          meta: m.meta,\n        };\n\n        const mReturnedValue = m.method(params);\n        let mStateToProcess;\n\n        if (\n          mReturnedValue === undefined &&\n          !isPromise(mReturnedValue) &&\n          !isGeneratorFunction(mReturnedValue) &&\n          !isAsyncGeneratorFunction(mReturnedValue)\n        ) {\n          mStateToProcess = params.state();\n        } else {\n          mStateToProcess = mReturnedValue;\n        }\n\n        await this.handleActionReturnTypes(mStateToProcess);\n      }\n    }\n  };\n\n  callSetStateCallback = (newState: State) => {\n    this._state = newState;\n    this._stateSetCallback(this._state, this._wrappedActions as any);\n  };\n\n  setMiddleware = (middleware: StactionMiddleware[]) => {\n    const grouped = middleware.reduce<{\n      pre: StactionMiddleware[];\n      post: StactionMiddleware[];\n    }>(\n      (acc, mw) => {\n        if (mw.type === 'pre') {\n          acc.pre.push(mw);\n        } else if (mw.type === 'post') {\n          acc.post.push(mw);\n        }\n        return acc;\n      },\n      { pre: [], post: [] }\n    );\n\n    this._preMiddleware = grouped.pre;\n    this._postMiddleware = grouped.post;\n  };\n\n  enableLogging = () => {\n    this._loggingEnabled = true;\n    return `Staction logging is enabled`;\n  };\n\n  disableLogging = () => {\n    this._loggingEnabled = false;\n    return `Staction logging is disabled`;\n  };\n\n  disableStateWhenLogging = () => {\n    this._addStateToLogs = false;\n  };\n\n  enableStateWhenLogging = () => {\n    this._addStateToLogs = true;\n  };\n}\n\nexport default Staction;\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","_regeneratorRuntime","r","t","e","n","Symbol","i","iterator","a","asyncIterator","u","toStringTag","c","value","configurable","writable","h","Generator","create","Error","done","method","arg","delegate","d","f","sent","_sent","dispatchException","abrupt","s","type","Context","wrap","GeneratorFunction","GeneratorFunctionPrototype","l","p","getPrototypeOf","y","x","v","g","forEach","_invoke","AsyncIterator","_typeof","resolve","__await","then","TypeError","next","w","tryEntries","push","m","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","unshift","pop","values","prev","charAt","slice","stop","rval","complete","finish","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","_defineProperty","toPrimitive","String","_toPrimitive","isPromise","testSub","isAsyncGeneratorFunction","Staction","_this","_classCallCheck","_state","_ref","_callee","newState","result","_result","_context","handleActionReturnTypes","callSetStateCallback","undefined","t0","_x","_ref2","_callee2","middleware","args","_iterator","_step","params","mReturnedValue","mStateToProcess","_context2","_createForOfIteratorHelper","state","getState","meta","_x2","_x3","_x4","_stateSetCallback","_wrappedActions","grouped","reduce","acc","mw","pre","post","_preMiddleware","_postMiddleware","_loggingEnabled","_addStateToLogs","_init","_callee3","actions","initFunc","stateSetCallback","errorMsg","err","initialStateCandidate","_this2","_context3","this","_initState","console","error","entries","_ref3","_ref4","_slicedToArray","actionFunc","_len","Array","_key","actionWrapper","concat","_actions","t1","_x5","_x6","_x7","_actionWrapper","_callee4","func","auxData","updateAuxData","_len2","_key2","_args4","_context4","log","valueOrUpdater","aux","processMiddleware","_x8","_x9"],"sourceRoot":""}